What MSF can do:

| **Infiltrate**           | **Collect Data**         | **Remediate**             |
| ------------------------ | ------------------------ | ------------------------- |
| Manual Exploitation      | Import and Scan Data     | Bruteforce                |
| Anti-virus Evasion       | Discovery Scans          | Task Chains               |
| IPS/IDS Evasion          | Meta-Modules             | Exploitation Workflow     |
| Proxy Pivot              | Nexpose Scan Integration | Session Rerun             |
| Post-Exploitation        |                          | Task Replay               |
| Session Clean-up         |                          | Project Sonar Integration |
| Credentials Reuse        |                          | Session Management        |
| Social Engineering       |                          | Credential Management     |
| Payload Generator        |                          | Team Collaboration        |
| Quick Pen-testing        |                          | Web Interface             |
| VPN Pivoting             |                          | Backup and Restore        |
| Vulnerability Validation |                          | Data Export               |
| Phishing Wizard          |                          | Evidence Collection       |
| Web App Testing          |                          | Reporting                 |
| Persistent Sessions      |                          | Tagging Data              |

### MSF Engangement Structure
![[Pentest Structure.png]]
- Enumeration
- Preparation
- Exploitation
- Privilege Escalation
- Post-Exploitation

### Types
|             |                                                                                                 |
| ----------- | ----------------------------------------------------------------------------------------------- |
| `Auxiliary` | Scanning, fuzzing, sniffing, and admin capabilities. Offer extra assistance and functionality.  |
| `Encoders`  | Ensure that payloads are intact to their destination.                                           |
| `Exploits`  | Defined as modules that exploit a vulnerability that will allow for the payload delivery.       |
| `NOPs`      | (No Operation code) Keep the payload sizes consistent across exploit attempts.                  |
| `Payloads`  | Code runs remotely and calls back to the attacker machine to establish a connection (or shell). |
| `Plugins`   | Additional scripts can be integrated within an assessment with `msfconsole` and coexist.        |
| `Post`      | Wide array of modules to gather information, pivot deeper, etc.                                 |
*OS*: Os tag refers to operating system
*Service*: Refers to vulnerable service running
*Name*: Usually a descriptive 

## Payloads
Payload refers to load delivered to system after stager

Three main payload types: *Singles, Stagers, Stages*
Whether or not a payload is staged is represented by `/` in the payload name.

For example, `windows/shell_bind_tcp` is a single payload with no stage, whereas `windows/shell/bind_tcp` consists of a stager (`bind_tcp`) and a stage (`shell`).

### Singles
A single payload that contains the exploit and the entire shell code for the selected task. 

### Stagers
Work with the stage form of a preformed task. 
A Stager waits on an attackers machine ready to establish a connection to the vulnerable machine. 
Stagers are typically used to establish a connection between victim and attaker.

### Stages
Stages are payload components downloaded by stagers. They are various payloads with no size limit, payload stages automatically using middle stagers.

### Staged Payload 
Exploitation process that is fully modularization and functionally separated to help segregate the process. Each stage is fully separated and separated in code blocks. 


The `Meterpreter` payload is a specific type of multi-faceted payload that uses `DLL injection` to ensure the connection to the victim host is stable, hard to detect by simple checks, and persistent across reboots or system changes.

Use grep to find payloads (show payloads)

## Encoders
Encoders change the program to make it compatible with different process architectures.
|`x64`|`x86`|`sparc`|`ppc`|`mips`|

Remove Hex bad characters. Most popular is SGN (Shikata ga nai) because payloads encoded through it are not universally detected.
`show Encoders`

## Workspaces
We can think of `Workspaces` the same way we would think of folders in a project. We can segregate the different scan results, hosts, and extracted information by IP, subnet, network, or domain.

## DB
We can import an nmap scan into our MSFconsole and then use this to enumerate potentially vulnerable services.


```shell-session
msfdb run
db_import Target.xml
```

### Using nmap from within msf
We dont need to import an external nmap scan we can instead use db_nmap

### Backing up data
`db_export`

## Plugins
```shell-session
ls /usr/share/metasploit-framework/plugins
```
to list plugins 

*nessus* is an automated vulnerability scanner we can load with load nessus

## Sessions 
MSFconsole can manage multiple modules at the same time which is done through sessions

*sessions* - Lists current sessions
*session -i X* - to start interacting with a session 

### Jobs
Using the jobs command allows us to run different exploits simultaniously
*jobs -h* 
if we use the -j flag on the *exploit* command.

***background*** to background a task and find another exploit

Set SESSION to run an exploit.

## Meterpreter 
Meterpreter uses dll injection to ensure stable hard to detect connection.
Meterpreter resides entirely in the memory of the remote connection so no files are left behind making it hard to detect with conventional forensic techniques.

Meterpreter is build to be Stealthy, Powerful and Extensible

***LOCAL_EXPLOIT_SUGGESTER*** USE THIS

