*Pivoting* is using a compromised machine to move to other networks through the compromised device.

Terms to describe compromised host used to *pivot* to a previously unreachable network.
- `Pivot Host`
- `Proxy`
- `Foothold`
- `Beach Head system`
- `Jump Host`

Used to defeat segmentation. Whereas *tunelling* is to encapsulate network traffic into another protocol and route traffic through it.

## Comparing Lateral Movement, Pivoting and Tunelling
### Lateral Movement
*Lateral Movement* is the technique used to further our access to additional `hosts`, `applications` and `services`.

Lateral movement can also help us gain access to specific domain resources we may need to elevate our privileges. This can often enable privilege
```
During an assessment, we gained initial access to the target environment and were able to gain control of the local administrator account. We performed a network scan and found three more Windows hosts in the network. We attempted to use the same local administrator credentials, and one of those devices shared the same administrator account. We used the credentials to move laterally to that other device, enabling us to compromise the domain further.
```

### Pivoting
Utilizing multiple hosts to cross `network` boundaries that we would not usually have access to. The goal is to move deeper into a network by compromising target host and infrastructure.

```
During one tricky engagement, the target had their network physically and logically separated. This separation made it difficult for us to move around and complete our objectives. We had to search the network and compromise a host that turned out to be the engineering workstation used to maintain and monitor equipment in the operational environment, submit reports, and perform other administrative duties in the enterprise environment. That host turned out to be dual-homed (having more than one physical NIC connected to different networks). Without it having access to both enterprise and operational networks, we would not have been able to pivot as we needed to complete our assessment.
```

_Look out for multiple nics?_ 

### Tunneling
Where we use common services and protocols to disguise traffic. (eg using HTTP to communicate with C&C Server). Obfuscation and Detection Avoidance.

```
One way we used Tunneling was to craft our traffic to hide in HTTP and HTTPS. This is a common way we maintained Command and Control (C2) of the hosts we had compromised within a network. We masked our instructions inside GET and POST requests that appeared as normal traffic and, to the untrained eye, would look like a web request or response to any old website. If the packet were formed properly, it would be forwarded to our Control server. If it were not, it would be redirected to another website, potentially throwing off the defender checking it out.
```


## The Network Behind Pivoting
### IP Addressing & NICs
Every computer communicating on a network needs an *IP*. *IP*s are usually obtained dynamically from a *DHCP* server. *IP* addresses can be static and commonly seen with:
- Servers
- Routers
- Switch virtual interfaces
- Printers
- And any devices that are providing critical services to the network

IP address assigned directly to *NIC* (`Network Interface Card`).
Always important to check for additional *NIC*s with
	`ifconfig` `Unix`
	`ipconfig` `Windows`

##### ifconfig
each NIC has an identifier (`eth`, `lo`, `tun0`)
- `tun0` Indicated a VPN

##### ipconfig
when network traffic is destined for an ip located on a different network, the computer will send traffic to its assigned *default gateway*

### Routing
`netstart -r` or `ip route`

Defining characteristic of a router is that it has a routing table that it uses to forward traffic based on the destination IP address.

*Routing Table* assists the system to make routing decisions. When a packet is created and has a destination before it leaves the computer, the routing table decides where to send it.
Any traffic destined for networks and not present in routing table will be sent to the default route. 

### Protocols, Services and Ports
*Protocols* are the rules that govern network communications. Many protocols have corresponding *ports* that act as identifiers.
An open *port* corresponds to an application we may be able to connect to.

## Dynamic Port Forwarding with SSH and SOCKS Tunelling
### Port Fowarding in Context
*Port Forwarding* is a technique that allows us to redirect a communication request from one port to another. 
*Port Forwarding* uses `TCP` as the primary communication layer 