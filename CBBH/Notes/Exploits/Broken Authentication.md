## What is Authentication
###### Authentication
"Process of verifying a claim that a system entity or a system resource has a certain attribute value"
*Confirming an entity's identity ensuring they are who they claim to be*

###### Authorization 
"Approval that is granted to a system entity to access a system resource"

![[AuthVSAuth.png]]

Most Widespread Authentication method is login forms.

### Common Authentication Methods
3 major categories
- Knowledge-based authentication
	- Based on knowledge factors i.e. passwords, passphrases, pin and security questions
- Ownership-based authentication
	- Proof of id with physical object or device, phones, security tokens, authenticator 
- Inherence-based authentication
	- Based on something the user does, biometrics, fingerprints, voice
	- Effective as biometric traits tied to individual user

2FA involved multiple authentication methods.

## Attacks on Authentication

- Knowledge Based Authentication
	- Social Engineering
	- Data Breaches
	- Brute forcing

- Ownership Based Authentication
	- Vulnerable to physical attacks, Stealing/cloning(NFC Tag in public, Sim)
	- Cryptographic attacks on authentication algorithm

- Attacking Inherence-based Authentication
	- Most Secure
	- If a breach happens, someone cant change their fingerprint.

## Enumerating Users
Vulnerabilities arise when a web app responds differently to registered/valid and invalid inputs for authentication endpoints.
***Devs often overlook Enumeration Vectors assuming info such as usernames are not confidential***
Usernames can be considered confidential if they are the primary identifier required for authentication in web applications. 

### Theory
Protection against username ENUM can have impact on user experience, if a website reveals if a username exists it might help a user identify if they failed to type their username correctly. 

### Enumerating Users via differing error message 
Brute force via usernames SecList and Filter by error.

Web application might not change display method but may only preform database lookups for valid usernames. Measure difference in response time to enumerate valid usernames.

## Brute-Forcing Passwords
See the module on [[BruteForce]] 
***password reuse*** Is a problem
Password leaks enable users to use passwords from data leaks on another web app (Password Spraying).

Weak paswords easy to brute force.

## Brute-Forcing Password Reset Tokens
If a user forgets their password the website will send them a one-time reset token. 
Weak password tokens may be brute-forced or predicted

### Identifying Weak Reset Tokens
Generated when user requests password reset.
Weak password tokens, possibly 4 characters long can be brute-forced
Assuming there are people in the process off resetting their passwords we can try brute force all active reset requests. If we want to target a specific user we will need to request a password reset.

## Brute-Forcing 2FA
one of the most common implementations relies on users password and OTP.
If valid credentials are obtained prior we must then get passed 2FA.

If a OTP relies on a 4 digit passcode it will easily be Brute-Forceable by fuzzing
## Weak Brute-Force Protection
Common types of brute-force protection mechanisms are rate limits and CAPTCHAs
### Rate Limits
Prevent servers being overwhelmed and prevent brute-force attacks by limiting number of requests allowed within a specified time frame. 

If the server relies on a reverse proxy, load balancer or web caches, the requests source ip belongs to middle box and not the attacker. Rate limit should be applied to attacker so many work based on IP address. 

Some rate limiters rely on `X-Forwarded-for` header to source IP address.
Attacker can send arbitrary IPs in the `X-Forwarded-for` header to throw off any rate limits.
`Completely Automated Public Turing test to tell Computers and Humans Apart (CAPTCHA)`

Many AI tools exist to solve CAPTCHAs 

## Default Credentials
Many times people forget to change default credentials of programs or  routers.
Testing default credentials is a part of the OWASP testing guide.
Seclists has default creds, there are other resources.
https://github.com/scadastrangelove/SCADAPASS/

Google is good to search too.

