## Introduction to Server-Side Attacks 
Attacks application provided by a server. 
Server side attacks include: 
- Server-Side Request Forgery (SSRF)
- Server-Side Template Injection (SSTI)
- Server-Side Includes Injection (SSI)
- eXtennsible Stylesheet Language Transformations (XSLT) Server-Side Injection

### SSRF
[Server-Side Request Forgery (SSRF)](https://owasp.org/www-community/attacks/Server_Side_Request_Forgery) is a vulnerability where an attacker manipulates web application into sending unauthorized requests from server. Occurs when user input controls applications HTTP requests to other servers. Allows ***bypass of firewalls***, ***accessing internal systems*** and ***retrieving sensitive information***. 

### SSTI
Web applications that use templating engines and server-side templates that generate responses to html content dynamically. This generation is based on user input enabling website to respond dynamically. [Server-Side Template Injection](https://owasp.org/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/07-Input_Validation_Testing/18-Testing_for_Server_Side_Template_Injection)

### SSI Injection
SSI directives instruct web server to include additional content dynamically. SSI can be used to include content that's present in all HTML Pages. When attacker can inject commands into SSI directives [Server-Side Includes (SSI) Injection](https://owasp.org/www-community/attacks/Server-Side_Includes_(SSI)_Injection) can occur. 

### XSLT Server-Side Injection
XSLT Injection occurs when attacker can manipulate XSLT transformations preformed on webserver. Used to transform XML to HTML and commonly employed in applications to generate content dynamically. exploitation of weaknesses in XSLT Leads to ACE

## Introduction to SSRF 
SSRF part of OWASP top 10. occurs when site fetches resources from remote location based on user supplied data. 

If web app relies on URL scheme attacker might be able to cause undesired behaviour by manipulating url scheme
- HTTP:// is usable to bypass WAFs or access restricted or internal endpoints
- FILE:// Reads file from local system, an attacker might use this to read local files on web server
- gopher:// can send arbitrary bytes to specified address 

## Identifying SSRF
Burp Request will have a URL request in the parameter (or obfuscated) indicates a web server is being contacted to fetch information from separate system.

To confirm SSRF vulnerability we can point the URL to our machine or local servers with nc listener.
If response contains data then we know it is not a blind SSRF
### Enumerating the system
Using this SSRF we can then begin to enumerate the local system, we can use 127.0.0.1:X and conduct an internal port scan of the system. 

We can fuzz internal ports with a custom wordlist and ffuf and the -fr (filter response) flag
```bash
seq 1 10000 > ports.txt
```

```shell-session
ffuf -w ./ports.txt -u http://172.17.0.2/index.php -X POST -H "Content-Type: application/x-www-form-urlencoded" -d "dateserver=http://127.0.0.1:FUZZ/&date=2024-01-01" -fr "Failed to connect to"
```

 ***Important add -H 'Content-Type: application/x-www-form-urlencoded'***

***Must match original protocol***

## Exploiting SSRF

### Accessing Restricted Endpoints 
Like enumerating ports we can enumerate directories with fuzzing.
- Determine response on Burp when we use an invalid directory
- filter response in FFUF to remove domains

May need to add file extension depending on web technology used

### Local File Inclusion (LFI)
We can use the `file://` url scheme to exploit possible local file inclusion ie: `file://etc/passwd`
possible to then exploit lfi vulnerabilities

### Gopher Protocol
